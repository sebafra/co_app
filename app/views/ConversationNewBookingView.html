<div id="itemViewNewConversation">
	<div class="container">
		<div class="panel panel-default">
			<div class="panel-body">
<!-- 				<form class="form-horizontal" role="form"> -->
<!-- 					<div class="form-group"> -->
<!-- 						<div class="col-xs-12 col-sm-12 amenities"> -->
<!-- 							<select class="form-control" name="amenities" id="amenities"> -->
<!-- 							</select> -->
<!-- 						</div> -->
<!-- 					</div> -->
							<button id="btnAmenities" type="button" class="btn btn-default btn-block selectAvatar">
				            	<span id="selectAmenities" class="selectAvatarText"></span>
				            	<div class="pull-right">
				            		<span class="icon ion-ios7-arrow-right"></span>
				            	</div>
				            </button>

					<div class="row">
						<div class="col-xs-6 col-sm-6">
							<div class="form-group fromInput">
								<label for="messageDateFrom">Desde:</label>
                                <% if(isDeviceOSIos()){%>
                                <input type="date" class="form-control" id="messageDateFrom">
                                <% } else { %>
                                <input type="text" class="form-control" id="messageDateFrom">
                                <% }%>

                            </div>
						</div>
						<div class="col-xs-6 col-sm-6">
							<div class="form-group toInput">
								<label for="messageDateTo">Hasta:</label>
                                <% if(isDeviceOSIos()){%>
                                <input type="date" class="form-control" id="messageDateTo">
                                <% } else { %>
                                <input type="text" class="form-control" id="messageDateTo">
                                <% }%>
							</div>
						</div>
					</div>
						<button type="button" class="btn btn-warning btn-lg btn-block" id="btnNewMessage">Enviar</button>
<!-- 			</form> -->
		</div>
		</div>
	</div>
</div>

<script>
$('#messageDateTo').focus(function(event) {
	pickDate($(this));
   /*var currentField = $(this);
   var myNewDate = Date.parse(currentField.val()) || new Date();

   // Same handling for iPhone and Android
   window.plugins.datePicker.show({
       date : myNewDate,
       mode : 'date', // date or time or blank for both
       allowOldDates : true
   }, function(returnDate) {
       currentField.val(returnDate);

       // This fixes the problem you mention at the bottom of this script with it not working a second/third time around, because it is in focus.
       currentField.blur();
   });*/
});
$('#messageDateFrom').focus(function(event) {
	pickDate($(this));
});
function pickDate(currentField){

   var myNewDate = new Date();
   if(currentField.val() != "")
	   myNewDate = getDateFromString(currentField.val()) ;

   // Same handling for iPhone and Android
   window.plugins.datePicker.show({
       date : myNewDate,
       mode : 'date', // date or time or blank for both
       allowOldDates : true
   }, function(returnDate) {
	try{
		   currentField.val(returnDate);
		   currentField.text(returnDate);
	}catch(e){
	}

	   currentField.blur();

	   // This fixes the problem you mention at the bottom of this script with it not working a second/third time around, because it is in focus.
       //alert("antes blur");
       //currentField.blur();
       //alert("despues blur");
   });
}

function getDateFromString(str){
	  var strSplit = str.split("-");
	  var strDate = new Date(strSplit[0], strSplit[1] - 1, strSplit[2]);
	  return strDate;
}
</script>
